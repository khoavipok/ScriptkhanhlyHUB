--// Menu Function
local TweenService = game:GetService("TweenService")

function CreateMenu(config)
    local title = config.Title or "Menu"
    local image = config.Image or ""
    local size = config.Size or UDim2.new(0, 250, 0, 350)

    -- ScreenGui
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Parent = game.CoreGui

    -- Main Frame
    local Frame = Instance.new("Frame")
    Frame.Size = size
    Frame.Position = UDim2.new(0.35, 0, 0.2, 0)
    Frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    Frame.Active = true
    Frame.Draggable = true
    Frame.Parent = ScreenGui

    local cornerMain = Instance.new("UICorner")
    cornerMain.CornerRadius = UDim.new(0, 12)
    cornerMain.Parent = Frame

    -- Background Image
    if image ~= "" then
        local BG = Instance.new("ImageLabel")
        BG.Size = UDim2.new(1, 0, 1, 0)
        BG.BackgroundTransparency = 1
        BG.Image = image
        BG.ScaleType = Enum.ScaleType.Crop
        BG.Parent = Frame

        local cornerBG = Instance.new("UICorner")
        cornerBG.CornerRadius = UDim.new(0, 12)
        cornerBG.Parent = BG
    end

    -- TopBar
    local TopBar = Instance.new("Frame")
    TopBar.Size = UDim2.new(1, 0, 0, 30)
    TopBar.BackgroundColor3 = Color3.fromRGB(30,30,30)
    TopBar.BackgroundTransparency = 0.3
    TopBar.BorderSizePixel = 0
    TopBar.Parent = Frame

    local cornerTop = Instance.new("UICorner")
    cornerTop.CornerRadius = UDim.new(0, 12)
    cornerTop.Parent = TopBar

    -- Title
    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(1, -60, 1, 0)
    Title.Position = UDim2.new(0, 10, 0, 0)
    Title.BackgroundTransparency = 1
    Title.Text = title
    Title.Font = Enum.Font.SourceSansBold
    Title.TextSize = 18
    Title.TextColor3 = Color3.fromRGB(255,255,255)
    Title.TextXAlignment = Enum.TextXAlignment.Left
    Title.Parent = TopBar

    -- Minimize button
    local MinBtn = Instance.new("TextButton")
    MinBtn.Size = UDim2.new(0, 30, 1, 0)
    MinBtn.Position = UDim2.new(1, -60, 0, 0)
    MinBtn.Text = "-"
    MinBtn.Font = Enum.Font.SourceSansBold
    MinBtn.TextSize = 20
    MinBtn.TextColor3 = Color3.fromRGB(255,255,255)
    MinBtn.BackgroundColor3 = Color3.fromRGB(70,70,70)
    MinBtn.Parent = TopBar

    local cornerMin = Instance.new("UICorner")
    cornerMin.CornerRadius = UDim.new(0, 8)
    cornerMin.Parent = MinBtn

    -- Close button
    local CloseBtn = Instance.new("TextButton")
    CloseBtn.Size = UDim2.new(0, 30, 1, 0)
    CloseBtn.Position = UDim2.new(1, -30, 0, 0)
    CloseBtn.Text = "X"
    CloseBtn.Font = Enum.Font.SourceSansBold
    CloseBtn.TextSize = 20
    CloseBtn.TextColor3 = Color3.fromRGB(255,255,255)
    CloseBtn.BackgroundColor3 = Color3.fromRGB(200,50,50)
    CloseBtn.Parent = TopBar

    local cornerClose = Instance.new("UICorner")
    cornerClose.CornerRadius = UDim.new(0, 8)
    cornerClose.Parent = CloseBtn

    -- Holder
    local Holder = Instance.new("Frame")
    Holder.Size = UDim2.new(1, -20, 1, -40)
    Holder.Position = UDim2.new(0, 10, 0, 35)
    Holder.BackgroundTransparency = 1
    Holder.ClipsDescendants = true
    Holder.Parent = Frame

    local layout = Instance.new("UIListLayout")
    layout.Parent = Holder
    layout.SortOrder = Enum.SortOrder.LayoutOrder
    layout.Padding = UDim.new(0, 8)
    layout.HorizontalAlignment = Enum.HorizontalAlignment.Center
    layout.VerticalAlignment = Enum.VerticalAlignment.Top

    -- Button events
    CloseBtn.MouseButton1Click:Connect(function()
        Frame:Destroy()
    end)

    local minimized = false
    local fullSize = size
    local minSize = UDim2.new(size.X.Scale, size.X.Offset, 0, 30)
    MinBtn.MouseButton1Click:Connect(function()
        minimized = not minimized
        local goal = {}
        if minimized then
            goal.Size = minSize
        else
            goal.Size = fullSize
        end
        TweenService:Create(Frame, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), goal):Play()
    end)

    return Holder
end
