local Version = "1.6.41"
local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/download/" .. Version .. "/main.lua"))()

WindUI:SetNotificationLower(true)

-- T·∫°o c·ª≠a s·ªï
local Window = WindUI:CreateWindow({
    Title = "Khanhly HUB X Plants Vs Brainrots",
    Icon = "rbxassetid://118993948043219", -- icon lucide
    Author = "Khanhly",
    Size = UDim2.fromOffset(600, 300),
    Theme = "Dark",
    Resizable = true,

    -- üî• ·∫¢nh n·ªÅn c·ªßa b·∫°n
    Background = "rbxassetid://74892959476466", -- 96368639036805 h√¨nh l·ªÅn
    BackgroundTransparency = 0.07, -- 0 = r√µ, 1 = t√†ng h√¨nh
})

Window:EditOpenButton({
    Title = "khanhly Hub",
    Icon = "rbxassetid://118993948043219",
    CornerRadius = UDim.new(0,16),
    StrokeThickness = 2,
    Color = ColorSequence.new( -- gradient
        Color3.fromHex("FF0F7B"), 
        Color3.fromHex("F89B29")
    ),
    OnlyMobile = false,
    Enabled = true,
    Draggable = true,
})

-- Tab ch√≠nh
local DsTab = Window:Tab({
    Title = "Discord",
    Icon = "user",
})

-- Gi·∫£ s·ª≠ b·∫°n ƒëang trong 1 Tab n√†o ƒë√≥
local Section = DsTab:Section({
    Title = "copy link discord",
    Icon = "heart",
    Opened = true
})

DsTab:Button({
    Title = "Copy Link Discord Khanhly",
    Desc = "Sao ch√©p link Discord v√†o clipboard",
    Callback = function()
        setclipboard("https://discord.com/invite/shkGwKQMaM")
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "‚úÖ ƒê√£ sao ch√©p!",
            Text = "Link Discord Khanhly ƒë√£ ƒë∆∞·ª£c copy v√†o clipboard.",
            Duration = 5
        })
    end,
})


-- Tab ch√≠nh
local MainTab = Window:Tab({
    Title = "Main",
    Icon = "sword",
})

-- Gi·∫£ s·ª≠ b·∫°n ƒëang trong 1 Tab n√†o ƒë√≥
local Section = MainTab:Section({
    Title = "Auto Farm",
    Icon = "sword",
    Opened = true
})

local VirtualInputManager = game:GetService("VirtualInputManager")

local autoClick = false
local ClickDelay = 0.01 -- t·ªëc ƒë·ªô click (0.01 = r·∫•t nhanh)

MainTab:Toggle({
    Title = "Auto attack",
    Desc = "farm attack",
    Default = false,
    Callback = function(state)
        autoClick = state
        print("Auto Click: " .. tostring(state))

        -- n·∫øu b·∫≠t th√¨ b·∫Øt ƒë·∫ßu click
        task.spawn(function()
            while autoClick do
                -- chu·ªôt tr√°i
                VirtualInputManager:SendMouseButtonEvent(0, 0, 0, true, game, 0)
                task.wait(ClickDelay)
                VirtualInputManager:SendMouseButtonEvent(0, 0, 0, false, game, 0)

                -- chu·ªôt ph·∫£i
                VirtualInputManager:SendMouseButtonEvent(0, 0, 1, true, game, 0)
                task.wait(ClickDelay)
                VirtualInputManager:SendMouseButtonEvent(0, 0, 1, false, game, 0)

                task.wait(ClickDelay)
            end
        end)
    end,
})


MainTab:Toggle({
    Title = "Auto Tp Brainrot",
    Desc = "tp farm",
    Default = false,
    Callback = function(state)
        print("Auto Follow: " .. tostring(state))

        if state then
            -- üß† Khi b·∫≠t
            getgenv().AutoFollowBrainrot = true

            task.spawn(function()
                local player = game.Players.LocalPlayer
                local character = player.Character or player.CharacterAdded:Wait()
                local hrp = character:WaitForChild("HumanoidRootPart")

                local brainrotsFolder = workspace:WaitForChild("ScriptedMap"):WaitForChild("Brainrots")
                local followSpeed = 50 -- ‚ö° t·ªëc ƒë·ªô di chuy·ªÉn (studs/gi√¢y)

                local function clearConstraints()
                    for _, v in pairs(hrp:GetChildren()) do
                        if v:IsA("AlignPosition") or v:IsA("Attachment") or v:IsA("WeldConstraint") then
                            v:Destroy()
                        end
                    end
                end

                local function attachTo(part)
                    clearConstraints()
                    local attach1 = Instance.new("Attachment", hrp)
                    local attach2 = Instance.new("Attachment", part)

                    local align = Instance.new("AlignPosition")
                    align.Attachment0 = attach1
                    align.Attachment1 = attach2
                    align.RigidityEnabled = false
                    align.MaxForce = 1e9
                    align.Responsiveness = followSpeed
                    align.Parent = hrp
                end

                while getgenv().AutoFollowBrainrot do
                    local targetBrainrot, targetPart
                    for _, obj in ipairs(brainrotsFolder:GetChildren()) do
                        local p = obj:IsA("BasePart") and obj or obj:FindFirstChildWhichIsA("BasePart")
                        if p then
                            targetBrainrot = obj
                            targetPart = p
                            break
                        end
                    end

                    if targetPart then
                        attachTo(targetPart)
                        repeat task.wait(0.1)
                        until not getgenv().AutoFollowBrainrot or not targetBrainrot or not targetBrainrot.Parent
                        clearConstraints()
                    else
                        repeat task.wait(0.5)
                        until not getgenv().AutoFollowBrainrot or #brainrotsFolder:GetChildren() > 0
                    end
                    task.wait(0.2)
                end

                clearConstraints()
                print("[üõë] ƒê√£ d·ª´ng Auto Follow Brainrot")
            end)
        else
            -- üß† Khi t·∫Øt
            getgenv().AutoFollowBrainrot = false
        end
    end,
})

local Section = MainTab:Section({
    Title = "Auto Farm coins + auto sell",
    Opened = true
})

-- ‚öôÔ∏è L·∫•y th√¥ng tin nh√¢n v·∫≠t
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")

local plotFolder = workspace:WaitForChild("Plots")
local plot = plotFolder:WaitForChild("1") -- n·∫øu mu·ªën ƒë·ªïi plot kh√°c, s·ª≠a ·ªü ƒë√¢y
local plantsFolder = plot:WaitForChild("Plants")

-- ‚öôÔ∏è H√†m TP m∆∞·ª£t
local function smoothTP(pos)
	hrp.CFrame = CFrame.new(pos + Vector3.new(0, 5, 0))
end

-- ‚öôÔ∏è H√†m g·ª≠i th√¥ng b√°o Roblox (trong su·ªët)
local function notify(title, text, duration)
	game.StarterGui:SetCore("SendNotification", {
		Title = title,
		Text = text,
		Duration = duration or 1.5
	})
end

-- üåø H√†m Auto TP (loop 1‚Üí17, quay l·∫°i 1 khi h·∫øt)
local function autoTPPlants()
	while task.wait(0.5) and getgenv()._AutoTPPlants do
		for i = 1, 17 do
			if not getgenv()._AutoTPPlants then break end

			local name = tostring(i)
			local plant = plantsFolder:FindFirstChild(name)

			if plant then
				local part = plant:IsA("BasePart") and plant or plant:FindFirstChildWhichIsA("BasePart")
				if part then
					smoothTP(part.Position)
					print("[üí∞] TP ƒë·∫øn coins s·ªë:", name)
					notify("üí∞ Auto TP coins", "ƒêang TP ƒë·∫øn c√¢y s·ªë " .. name, 1.2)
				else
					warn("[‚ö†Ô∏è] C√¢y " .. name .. " kh√¥ng c√≥ BasePart ƒë·ªÉ TP")
				end
			else
				print("[‚ùå] Kh√¥ng t√¨m th·∫•y coins s·ªë:", name)
			end

			task.wait(0.4) -- delay m·ªói l·∫ßn TP
		end

		-- Sau khi xong 1‚Üí17, quay l·∫°i 1
		if getgenv()._AutoTPPlants then
			local first = plantsFolder:FindFirstChild("1")
			if first then
				local part = first:IsA("BasePart") and first or first:FindFirstChildWhichIsA("BasePart")
				if part then
					smoothTP(part.Position)
					print("[üîÅ] Quay l·∫°i c√¢y s·ªë 1...")
					notify("üîÅ Auto TP coins", "Quay l·∫°i c√¢y s·ªë 1", 1.3)
				end
			end
		end
	end

	print("[‚õî] ƒê√£ d·ª´ng Auto TP coind.")
	notify("‚õî Auto TP coins", "ƒê√£ d·ª´ng ho·∫°t ƒë·ªông", 2)
end

-- üü¢ Toggle ƒëi·ªÅu khi·ªÉn trong WindUI
MainTab:Toggle({
	Title = "Auto TP coins",
	Desc = "Auto TP each coins",
	Default = false,
	Callback = function(state)
		getgenv()._AutoTPPlants = state

		if state then
			print("[üü¢] B·∫≠t Auto TP coins")
			notify("üü¢ Auto TP coins", "ƒêang b·∫≠t ch·∫ø ƒë·ªô Auto TP coins", 2)
			task.spawn(autoTPPlants)
		else
			print("[üî¥] T·∫Øt Auto TP coins")
			notify("üî¥ Auto TP coins", "ƒê√£ t·∫Øt ch·∫ø ƒë·ªô Auto TP coins", 2)
		end
	end,
})

local StarterGui = game:GetService("StarterGui")
local Remotes = game:GetService("ReplicatedStorage").Remotes

-- H√†m hi·ªán th√¥ng b√°o trong su·ªët (gi·ªëng Roblox g·ªëc)
local function Notify(title, text, time)
    pcall(function()
        StarterGui:SetCore("SendNotification", {
            Title = title,
            Text = text,
            Duration = time or 2
        })
    end)
end

-- üîπ TOGGLE 1: AUTO EQUIP
MainTab:Toggle({
    Title = "Auto receive coins",
    Desc = "T·ª± ƒë·ªông g·ªçi EquipBestBrainrots m·ªói 2 gi√¢y",
    Default = false,
    Callback = function(state)
        _G.AutoEquip = state

        Notify("Auto Equip", state and "üü¢ ƒê√£ b·∫≠t auto equip!" or "üî¥ ƒê√£ t·∫Øt auto equip!", 2)

        task.spawn(function()
            while _G.AutoEquip do
                pcall(function()
                    Remotes.EquipBestBrainrots:FireServer()
                end)
                Notify("Auto Equip", "‚úÖ received coins!!", 2)
                task.wait(2)
            end
        end)
    end,
})

-- üîπ TOGGLE 2: AUTO SELL
MainTab:Toggle({
    Title = "Auto Sell Items",
    Desc = "T·ª± ƒë·ªông g·ªçi ItemSell m·ªói 2 gi√¢y",
    Default = false,
    Callback = function(state)
        _G.AutoSell = state

        Notify("Auto Sell", state and "‚úÖ ƒê√£ On auto sell!" or "‚ùå ƒê√£ off auto sell!", 2)

        task.spawn(function()
        while _G.AutoSell do
            pcall(function()
                Remotes.ItemSell:FireServer()
            end)
            Notify("Auto Sell", "üí∞ ItemSell ", 2)
            task.wait(2)
        end
        end)
    end,
})


local SpTab = Window:Tab({
    Title = "auto buy shop",
    Icon = "star",
})

-- Gi·∫£ s·ª≠ b·∫°n ƒëang trong 1 Tab n√†o ƒë√≥
local Section = SpTab:Section({
    Title = "Auto buy seeds",
    Icon = "lucide:star",
    Opened = true
})

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Remote = ReplicatedStorage.Remotes.BuyItem

-- H√†m t·∫°o toggle ri√™ng cho t·ª´ng seed
local function createSeedToggle(tab, seedName)
    local active = false

    tab:Toggle({
        Title = seedName,
        Desc = "T·ª± ƒë·ªông mua " .. seedName,
        Default = false,
        Callback = function(state)
            active = state

            -- Th√¥ng b√°o b·∫≠t/t·∫Øt
            game.StarterGui:SetCore("SendNotification", {
                Title = "Auto Buy " .. seedName,
                Text = state and "ƒê√£ b·∫≠t" or "ƒê√£ t·∫Øt",
                Duration = 2
            })

            -- N·∫øu b·∫≠t th√¨ spam li√™n t·ª•c
            if state then
                task.spawn(function()
                    while active do
                        Remote:FireServer(seedName)
                        task.wait(0.2)
                    end
                end)
            end
        end
    })
end

-- Danh s√°ch t·∫•t c·∫£ seeds (‚úÖ ƒë√£ th√™m King Limone Seed ngay sau Mango Seed)
local seeds = {
    "Mango Seed",
    "King Limone Seed", -- ‚úÖ th√™m v√†o ƒë√¢y
    "Shroombino Seed",     
    "Tomatrio Seed",
    "Mr Carrot Seed",
    "Carnivorous Plant Seed",
    "Cocotank Seed",
    "Watermelon Seed",
    "Eggplant Seed",
    "Dragon Frult Seed",
    "Sunflower Seed",
    "Pumpkin Seed",
    "Strawberry Seed",
    "Cactus Seed",
}

-- T·∫°o toggle cho t·ª´ng seed
for _, seed in ipairs(seeds) do
    createSeedToggle(SpTab, seed)
end

-- Gi·∫£ s·ª≠ b·∫°n ƒëang trong 1 Tab n√†o ƒë√≥
local Section = SpTab:Section({
    Title = "Auto buy gear",
    Icon = "star",
    Opened = true
})

-- Gi·∫£ s·ª≠ b·∫°n ƒë√£ c√≥ SpTab t·ª´ WindUI
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Remote = ReplicatedStorage.Remotes.BuyGear

-- H√†m t·∫°o toggle ri√™ng cho t·ª´ng Gear
local function createGearToggle(tab, gearName)
    local active = false

    tab:Toggle({
        Title = gearName,
        Desc = "T·ª± ƒë·ªông mua " .. gearName,
        Default = false,
        Callback = function(state)
            active = state

            -- Th√¥ng b√°o b·∫≠t/t·∫Øt
            game.StarterGui:SetCore("SendNotification", {
                Title = "Auto Buy " .. gearName,
                Text = state and "ƒê√£ b·∫≠t" or "ƒê√£ t·∫Øt",
                Duration = 2
            })

            -- N·∫øu b·∫≠t ‚Üí b·∫Øt ƒë·∫ßu spam mua
            if state then
                task.spawn(function()
                    while active do
                        Remote:FireServer(gearName)
                        task.wait(0.2) -- t·ªëc ƒë·ªô spam (gi·∫£m s·ªë nh·ªè ƒë·ªÉ mua nhanh h∆°n)
                    end
                end)
            end
        end
    })
end

-- Danh s√°ch Gear
local gears = {
    "Water Bucket",
    "Frost Grenade",
    "Banana Gun",
    "Frost Blower",
    "Carrot Launcher"
}

-- T·∫°o toggle ri√™ng cho t·ª´ng Gear
for _, gear in ipairs(gears) do
    createGearToggle(SpTab, gear)
end

local BgTab = Window:Tab({
    Title = "Event",
    Icon = "zap",
})

local Section = BgTab:Section({
    Title = "Event",
    Icon = "star",
    Opened = true
})

BgTab:Button({
    Title = "TP event portal",
    Desc = "tp portal",
    Callback = function()
        local player = game.Players.LocalPlayer
        local character = player.Character or player.CharacterAdded:Wait()
        local hrp = character:WaitForChild("HumanoidRootPart")

        -- Teleport
        hrp.CFrame = CFrame.new(Vector3.new(-175.4, 11.6, 987.8))

        -- Th√¥ng b√°o Roblox trong su·ªët
        game.StarterGui:SetCore("SendNotification", {
            Title = "Teleport Th√†nh c√¥ng ‚úÖ",
            Text = "üïë loading.....",
            Duration = 4
        })
    end,
})


local ReplicatedStorage = game:GetService("ReplicatedStorage")
local BuyPortalRemote = ReplicatedStorage.Remotes.BuyPortal

local active = false

BgTab:Toggle({
    Title = "Auto Buy Portal",
    Desc = "Mua Portal li√™n t·ª•c",
    Default = false,
    Callback = function(state)
        active = state

        -- Th√¥ng b√°o b·∫≠t/t·∫Øt
        game.StarterGui:SetCore("SendNotification", {
            Title = "Auto Buy Portal",
            Text = state and "ƒê√£ b·∫≠t" or "ƒê√£ t·∫Øt",
            Duration = 2
        })

        -- N·∫øu b·∫≠t th√¨ loop li√™n t·ª•c
        if state then
            task.spawn(function()
                while active do
                    BuyPortalRemote:FireServer()
                    task.wait(0.2) -- t·ªëc ƒë·ªô mua
                end
            end)
        end
    end
})


-- Toggle auto EventPlatforms
BgTab:Toggle({
    Title = "Auto Event shiny card pack",
    Desc = "auto farm pranium",
    Default = false,
    Callback = function(state)
        local StarterGui = game:GetService("StarterGui")
        local function Notify(title, text)
            StarterGui:SetCore("SendNotification", {
                Title = title,
                Text = text,
                Duration = 3, -- th·ªùi gian hi·ªÉn th·ªã
            })
        end

        Notify("Auto EventPlatforms", state and "‚úÖ ON" or "üõë OFF")

        if not state then
            _G.EventAuto = false
            return
        end

        _G.EventAuto = true

        local Players = game:GetService("Players")
        local player = Players.LocalPlayer
        local char = player.Character or player.CharacterAdded:Wait()
        local root = char:WaitForChild("HumanoidRootPart")
        local plot = workspace.Plots["1"].EventPlatforms

        -- T·ªça ƒë·ªô ch√≠nh x√°c
        local platformPositions = {
            ["-4"] = Vector3.new(-221.7, 14.4, 993.8),
            ["-3"] = Vector3.new(-222.8, 14.4, 983.8),
            ["-2"] = Vector3.new(-222.4, 14.4, 974.6),
            ["-1"] = Vector3.new(-221.8, 14.4, 963.5),
        }

        -- H√†m t√¨m tool tr√πng t√™n pet
        local function findToolByPetName(petName)
            local backpack = player:WaitForChild("Backpack")
            for _, tool in ipairs(backpack:GetChildren()) do
                if string.find(tool.Name, petName) then
                    return tool
                end
            end
            return nil
        end

        -- H√†m teleport
        local function teleportToPlatformID(id)
            local pos = platformPositions[id]
            if pos then
                root.CFrame = CFrame.new(pos + Vector3.new(0, 5, 0))
                Notify("TP Th√†nh c√¥ng", "ƒê·∫øn Platform " .. id)
            end
        end

        -- H√†m k√≠ch ho·∫°t ProximityPrompt
        local function triggerPrompt(prompt)
            if fireproximityprompt then
                fireproximityprompt(prompt)
            else
                Notify("‚ö†Ô∏è error", "Executor kh√¥ng h·ªó tr·ª£ fireproximityprompt")
            end
        end

        -- V√≤ng l·∫∑p ch√≠nh auto
        task.spawn(function()
            while _G.EventAuto do
                for id, pos in pairs(platformPositions) do
                    if not _G.EventAuto then break end

                    local platform = plot:FindFirstChild(id)
                    if platform then
                        local visual = platform:FindFirstChild("VisualFolder")
                        if visual then
                            for _, pet in ipairs(visual:GetChildren()) do
                                local petName = pet.Name
                                local tool = findToolByPetName(petName)
                                if tool then
                                    Notify("‚ö° brainrotsT√¨m Th·∫•y", tool.Name)
                                    tool.Parent = char
                                    task.wait(0.5)
                                    teleportToPlatformID(id)

                                    -- t√¨m Prompt ƒë·ªÉ k√≠ch ho·∫°t
                                    local hitbox = platform:FindFirstChild("Hitbox")
                                    if hitbox then
                                        local prompt = hitbox:FindFirstChildOfClass("ProximityPrompt")
                                        if prompt then
                                            task.wait(0.3)
                                            triggerPrompt(prompt)
                                            Notify("‚öôÔ∏è ƒêang K√≠ch Ho·∫°t", "Platform " .. id)
                                        end
                                    end
                                else
                                    Notify("‚ùìThi·∫øu Brainrots", petName)
                                end
                            end
                        end
                    end
                    task.wait(2)
                end
            end
            Notify("üõë D·ª´ng Auto", "Auto EventPlatforms ƒë√£ t·∫Øt")
        end)
    end,
})


local RS = game:GetService("ReplicatedStorage")
local StarterGui = game:GetService("StarterGui")
local Remote = RS.Remotes.MissionServicesRemotes.RequestStartInvasion

BgTab:Toggle({
    Title = "Auto Event assault brainrots",
    Desc = "Auto assault brainrots",
    Default = false,
    Callback = function(state)
        print("Auto Invasion:", state)

        -- Th√¥ng b√°o Roblox trong su·ªët
        StarterGui:SetCore("SendNotification", {
            Title = "‚öîÔ∏è Auto Invasion",
            Text = state and "ƒê√£ b·∫≠t t·ª± ƒë·ªông k√≠ch ho·∫°t!" or "ƒê√£ t·∫Øt t·ª± ƒë·ªông k√≠ch ho·∫°t!",
            Duration = 3 -- th·ªùi gian hi·ªÉn th·ªã (gi√¢y)
        })

        if state then
            _G.AutoInvasion = true
            task.spawn(function()
                while _G.AutoInvasion do
                    Remote:FireServer()
                    task.wait(5) -- l·∫∑p l·∫°i m·ªói 5 gi√¢y (c√≥ th·ªÉ ch·ªânh)
                end
            end)
        else
            _G.AutoInvasion = false
        end
    end,
})


local player = game:GetService("Players").LocalPlayer
local backpack = player:WaitForChild("Backpack")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Remote TurnIn
local TurnInRemote = ReplicatedStorage.Remotes.Events.Artist.Interact

BgTab:Toggle({
    Title = "Auto brainrot deliver",
    Desc = "auto farm event ",
    Default = false,
    Callback = function(state)
        print("Equip + TurnIn: " .. tostring(state))

        if state then
            getgenv().EquipTurnInLoop = true

            task.spawn(function()
                while getgenv().EquipTurnInLoop do
                    local tools = backpack:GetChildren()

                    for _, tool in ipairs(tools) do
                        if not getgenv().EquipTurnInLoop then break end
                        if tool:IsA("Tool") and string.find(tool.Name, "kg") then
                            -- C·∫ßm tool
                            tool.Parent = player.Character
                            task.wait(0.12)

                            -- G·ªçi TurnIn
                            TurnInRemote:FireServer("TurnIn")

                            -- C·∫•t tool l·∫°i
                            if tool and tool.Parent == player.Character then
                                tool.Parent = backpack
                            end

                            task.wait(0.05)
                        end
                    end

                    -- G·ªçi th√™m TurnIn li√™n t·ª•c m·ªói v√≤ng
                    TurnInRemote:FireServer("TurnIn")

                    task.wait(0.1)
                end
            end)
        else
            getgenv().EquipTurnInLoop = false
        end
    end,
})


local Section = BgTab:Section({
    Title = "Bug lag",
    Icon = "star",
    Opened = true
})

-- Gi·∫£ s·ª≠ b·∫°n ƒë√£ c√≥ BgTab ·ªü tr√™n r·ªìi
-- BgTab:Toggle(...) s·∫Ω t·∫°o toggle ƒëi·ªÅu khi·ªÉn auto equip

local player = game:GetService("Players").LocalPlayer
local backpack = player:WaitForChild("Backpack")

local connection -- gi·ªØ k·∫øt n·ªëi ƒë·ªÉ ng·∫Øt khi t·∫Øt toggle
local running = false

BgTab:Toggle({
    Title = "Auto bug Lag‚ö†Ô∏è",
    Desc = "T·ª± ƒë·ªông c·∫ßm t·∫•t c·∫£ tool trong Backpack",
    Default = false,
    Callback = function(state)
        print("Toggle: " .. tostring(state))
        running = state

        if state then
            -- Khi b·∫≠t toggle
            local function equipAll()
                for _, tool in ipairs(backpack:GetChildren()) do
                    if not running then return end
                    if tool:IsA("Tool") then
                        tool.Parent = player.Character
                        task.wait(0.2)
                    end
                end
            end

            -- G·ªçi l√∫c ƒë·∫ßu
            equipAll()

            -- Theo d√µi khi c√≥ tool m·ªõi
            connection = backpack.ChildAdded:Connect(function(tool)
                if not running then return end
                if tool:IsA("Tool") then
                    task.wait(0.2)
                    tool.Parent = player.Character
                end
            end)
        else
            -- Khi t·∫Øt toggle
            running = false
            if connection then
                connection:Disconnect()
                connection = nil
            end
        end
    end,
})

-- Tab ch√≠nh
local FlTab = Window:Tab({
    Title = "Visual",
    Icon = "brain",
})

-- Gi·∫£ s·ª≠ b·∫°n ƒëang trong 1 Tab n√†o ƒë√≥
local Section = FlTab:Section({
    Title = "character function",
    Icon = "brain",
    Opened = true
})


-------------------------------------------------
--// Th√¥ng b√°o ki·ªÉu Roblox
-------------------------------------------------
local function TransparentNotify(text)
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "esp Player loading üïë.....",
        Text = text,
        Duration = 2
    })
end

-------------------------------------------------
--// ESP (Highlight + T√™n + Kho·∫£ng c√°ch)
-------------------------------------------------
local espEnabled = false
local espObjects = {}

local function createESP(player)
    if player == game.Players.LocalPlayer then return end
    if not player.Character then return end

    -- Highlight
    local highlight = Instance.new("Highlight")
    highlight.Adornee = player.Character
    highlight.FillTransparency = 1
    highlight.OutlineColor = Color3.fromRGB(255, 50, 50)
    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
    highlight.Parent = player.Character

    -- Billboard hi·ªÉn th·ªã t√™n + kho·∫£ng c√°ch
    local billboard = Instance.new("BillboardGui")
    billboard.Name = "NameESP"
    billboard.Adornee = player.Character:FindFirstChild("Head") or player.Character:FindFirstChildWhichIsA("BasePart")
    billboard.Size = UDim2.new(0, 200, 0, 50)
    billboard.AlwaysOnTop = true
    billboard.StudsOffset = Vector3.new(0, 2.5, 0)

    local text = Instance.new("TextLabel")
    text.Size = UDim2.new(1, 0, 1, 0)
    text.BackgroundTransparency = 1
    text.TextColor3 = Color3.fromRGB(255, 100, 100)
    text.TextStrokeTransparency = 0
    text.Font = Enum.Font.GothamBold
    text.TextScaled = true
    text.Parent = billboard

    billboard.Parent = player.Character

    espObjects[player] = { highlight = highlight, billboard = billboard, text = text }

    -- C·∫≠p nh·∫≠t kho·∫£ng c√°ch li√™n t·ª•c
    task.spawn(function()
        while espEnabled and player and player.Character and espObjects[player] do
            local root = player.Character:FindFirstChild("HumanoidRootPart")
            local localRoot = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
            if root and localRoot then
                local distance = (root.Position - localRoot.Position).Magnitude
                espObjects[player].text.Text = string.format("%s - %.0fm", player.DisplayName, distance)
            end
            task.wait(0.2)
        end
    end)
end

local function removeESP(player)
    if espObjects[player] then
        for _, v in pairs(espObjects[player]) do
            if typeof(v) == "Instance" then
                v:Destroy()
            end
        end
        espObjects[player] = nil
    end
end

-------------------------------------------------
--// Toggle ch√≠nh
-------------------------------------------------
FlTab:Toggle({
    Title = "ESP Player",
    Desc = "Hi·ªÉn th·ªã t√™n + kho·∫£ng c√°ch (m)",
    Default = false,
    Callback = function(state)
        espEnabled = state
        TransparentNotify(state and "ƒê√£ b·∫≠t ESP!" or "ƒê√£ t·∫Øt ESP!")

        if espEnabled then
            -- Th√™m cho ng∆∞·ªùi ch∆°i hi·ªán c√≥
            for _, p in pairs(game.Players:GetPlayers()) do
                if p.Character then
                    createESP(p)
                end
            end

            -- Khi ng∆∞·ªùi ch∆°i m·ªõi v√†o
            game.Players.PlayerAdded:Connect(function(p)
                p.CharacterAdded:Connect(function()
                    if espEnabled then
                        createESP(p)
                    end
                end)
            end)

            -- Khi ng∆∞·ªùi ch∆°i r·ªùi
            game.Players.PlayerRemoving:Connect(function(p)
                removeESP(p)
            end)
        else
            -- T·∫Øt ESP
            for _, data in pairs(espObjects) do
                for _, v in pairs(data) do
                    if typeof(v) == "Instance" then
                        v:Destroy()
                    end
                end
            end
            espObjects = {}
        end
    end,
})


-------------------------------------------------
--// Th√¥ng b√°o trong su·ªët (gi·ªëng Roblox)
-------------------------------------------------
local function TransparentNotify(text)
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Khanhly HUB",
        Text = text,
        Duration = 2
    })
end

-------------------------------------------------
--// Infinite Jump
-------------------------------------------------
local infiniteJumpEnabled = false

FlTab:Toggle({
    Title = "Infinite Jump",
    Desc = "B·∫≠t/T·∫Øt nh·∫£y v√¥ h·∫°n",
    Default = false,
    Callback = function(state)
        infiniteJumpEnabled = state
        TransparentNotify(state and "ƒê√£ b·∫≠t Infinite Jump!" or "ƒê√£ t·∫Øt Infinite Jump!")
    end,
})

-- X·ª≠ l√Ω nh·∫£y v√¥ h·∫°n
game:GetService("UserInputService").JumpRequest:Connect(function()
    if infiniteJumpEnabled then
        local player = game:GetService("Players").LocalPlayer
        local char = player.Character
        if char and char:FindFirstChildOfClass("Humanoid") then
            char:FindFirstChildOfClass("Humanoid"):ChangeState("Jumping")
        end
    end
end)

-------------------------------------------------
--// Noclip
-------------------------------------------------
local noclipEnabled = false

FlTab:Toggle({
    Title = "Noclip",
    Desc = "ƒêi xuy√™n v·∫≠t th·ªÉ",
    Default = false,
    Callback = function(state)
        noclipEnabled = state
        TransparentNotify(state and "ƒê√£ b·∫≠t Noclip!" or "ƒê√£ t·∫Øt Noclip!")
    end,
})

-- X·ª≠ l√Ω noclip
game:GetService("RunService").Stepped:Connect(function()
    if noclipEnabled then
        local char = game:GetService("Players").LocalPlayer.Character
        if char then
            for _, part in pairs(char:GetDescendants()) do
                if part:IsA("BasePart") and part.CanCollide then
                    part.CanCollide = false
                end
            end
        end
    end
end)

-------------------------------------------------
--// Speed Slider (h·ªó tr·ª£ k√©o)
-------------------------------------------------
local player = game:GetService("Players").LocalPlayer
local speed = 16

local Slider = FlTab:Slider({
    Title = "Speed",
    Desc = "ƒêi·ªÅu ch·ªânh t·ªëc ƒë·ªô di chuy·ªÉn",
    Step = 1,
    Value = {
        Min = 16,
        Max = 200,
        Default = 16,
    },
    Callback = function(value)
        speed = value
        local humanoid = player.Character and player.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = speed
        end
        TransparentNotify("T·ªëc ƒë·ªô hi·ªán t·∫°i: " .. speed)
    end
})

-- Gi·ªØ l·∫°i speed sau khi respawn
player.CharacterAdded:Connect(function(char)
    local hum = char:WaitForChild("Humanoid")
    hum.WalkSpeed = speed
end)

-- Tab ch√≠nh
local StTab = Window:Tab({
    Title = "Settings",
    Icon = "settings",
})

-- Gi·∫£ s·ª≠ b·∫°n ƒëang trong 1 Tab n√†o ƒë√≥
local Section = StTab:Section({
    Title = "anti lag + anti Afk",
    Icon = "brain",
    Opened = true
})


local AntiLagLevel = "Normal"

-- üéöÔ∏è Dropdown ch·ªçn ch·∫ø ƒë·ªô
StTab:Dropdown({
    Title = "Anti-Lag Mode",
    Desc = "Ch·ªçn m·ª©c gi·∫£m lag",
    Values = { "Normal", "Low", "Super Low", "Wireframe" },
    Value = "Normal",
    Callback = function(selected)
        AntiLagLevel = selected

        -- üîÑ Kh√¥i ph·ª•c m·∫∑c ƒë·ªãnh
        if AntiLagLevel == "Normal" then
            settings().Rendering.QualityLevel = Enum.QualityLevel.Automatic
            game.Lighting.GlobalShadows = true
            game.Lighting.FogEnd = 1000
            game.Lighting.Brightness = 2
            game.Lighting.OutdoorAmbient = Color3.new(0.5, 0.5, 0.5)

            WindUI:Notify({
                Title = "Anti-Lag Mode",
                Content = "ƒê√£ kh√¥i ph·ª•c ch·∫ø ƒë·ªô Normal.",
                Duration = 3,
                Type = "info"
            })
            return
        end

        -- ‚öôÔ∏è C·∫•u h√¨nh gi·∫£m lag
        settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
        game.Lighting.GlobalShadows = false
        game.Lighting.FogEnd = 9999
        game.Lighting.Brightness = 1
        game.Lighting.OutdoorAmbient = Color3.new(1, 1, 1)

        local function optimize(v)
            -- üî• T·∫Øt hi·ªáu ·ª©ng
            if v:IsA("ParticleEmitter") or v:IsA("Trail") or v:IsA("Smoke") 
            or v:IsA("Fire") or v:IsA("Sparkles") or v:IsA("Beam") then
                v.Enabled = false
            end

            -- üß± Gi·∫£m chi ti·∫øt v·∫≠t th·ªÉ
            if v:IsA("MeshPart") or v:IsA("Part") then
                v.Material = Enum.Material.SmoothPlastic
                v.CastShadow = false
                v.Color = Color3.fromRGB(60, 60, 60)

                if AntiLagLevel == "Wireframe" then
                    v.Transparency = 0.3
                else
                    v.Transparency = 0
                end

                if v:IsA("MeshPart") then
                    v.TextureID = ""
                end
            end

            -- üëï X√≥a qu·∫ßn √°o
            if v:IsA("Shirt") or v:IsA("Pants") then
                v:Destroy()
            end
            if v:IsA("BodyColors") then
                for _, colorName in ipairs({
                    "HeadColor", "LeftArmColor", "RightArmColor",
                    "LeftLegColor", "RightLegColor", "TorsoColor"
                }) do
                    v[colorName] = BrickColor.new("Dark stone grey")
                end
            end

            -- ü™ñ Super Low & Wireframe: xo√° th√™m ph·ª• ki·ªán
            if AntiLagLevel == "Super Low" or AntiLagLevel == "Wireframe" then
                if v:IsA("Accessory") or v:IsA("Hat") or v:IsA("Decal") then
                    v:Destroy()
                end
            end
        end

        -- üåç Qu√©t map v√† nh√¢n v·∫≠t
        for _, v in pairs(workspace:GetDescendants()) do
            optimize(v)
        end
        workspace.DescendantAdded:Connect(optimize)

        for _, p in pairs(game.Players:GetPlayers()) do
            if p.Character then
                for _, part in pairs(p.Character:GetDescendants()) do
                    optimize(part)
                end
            end
        end

        -- üîî Th√¥ng b√°o WindUI
        WindUI:Notify({
            Title = "Anti-Lag Mode",
            Content = "ƒê√£ b·∫≠t ch·∫ø ƒë·ªô: " .. AntiLagLevel,
            Duration = 3,
            Type = "success"
        })
    end,
})




-- üß© Script Anti AFK (WindUI version)
local Players = game:GetService("Players")
local VirtualUser = game:GetService("VirtualUser")

local player = Players.LocalPlayer
local antiAfkConnection
local notifyLoop -- v√≤ng l·∫∑p th√¥ng b√°o

-- üß∑ Toggle WindUI
StTab:Toggle({
    Title = "Anti AFK",
    Desc = "T·ª± ƒë·ªông tr√°nh kick AFK",
    Default = false,
    Callback = function(Value)
        if Value then
            -- üîõ B·∫≠t Anti AFK
            antiAfkConnection = player.Idled:Connect(function()
                VirtualUser:Button2Down(Vector2.new(0, 0))
                task.wait(0.5)
                VirtualUser:Button2Up(Vector2.new(0, 0))
            end)

            -- üîî Th√¥ng b√°o b·∫≠t
            WindUI:Notify({
                Title = "Anti AFK",
                Content = "ƒê√£ b·∫≠t th√†nh c√¥ng!",
                Duration = 4,
                Type = "success"
            })

            -- ‚è∞ Th√¥ng b√°o m·ªói 20 ph√∫t
            notifyLoop = task.spawn(function()
                while task.wait(1200) do
                    WindUI:Notify({
                        Title = "Anti AFK",
                        Content = "V·∫´n ƒëang ho·∫°t ƒë·ªông!",
                        Duration = 4,
                        Type = "info"
                    })
                end
            end)
        else
            -- üî¥ T·∫Øt Anti AFK
            if antiAfkConnection then
                antiAfkConnection:Disconnect()
                antiAfkConnection = nil
            end

            -- üõë D·ª´ng v√≤ng l·∫∑p
            if notifyLoop then
                task.cancel(notifyLoop)
                notifyLoop = nil
            end

            -- üîî Th√¥ng b√°o t·∫Øt
            WindUI:Notify({
                Title = "Anti AFK",
                Content = "ƒê√£ t·∫Øt!",
                Duration = 4,
                Type = "error"
            })
        end
    end,
})

-- Gi·∫£ s·ª≠ b·∫°n ƒëang trong 1 Tab n√†o ƒë√≥
local Section = StTab:Section({
    Title = "Hop Sever",
    Icon = "brain",
    Opened = true
})


-- üåê D·ªãch v·ª• Roblox
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local Players = game:GetService("Players")

-- üîÅ H√†m Server Hop
local function serverHop()
    local gameId = game.PlaceId
    local currentJobId = game.JobId
    local servers = {}

    -- üß≠ L·∫•y danh s√°ch server
    local success, result = pcall(function()
        return game:HttpGet("https://games.roblox.com/v1/games/" .. gameId .. "/servers/Public?sortOrder=Asc&limit=100")
    end)

    if not success then
        WindUI:Notify({
            Title = "Server Hop",
            Content = "‚ö†Ô∏è Kh√¥ng l·∫•y ƒë∆∞·ª£c danh s√°ch server.",
            Duration = 4,
            Type = "error"
        })
        return
    end

    local data = HttpService:JSONDecode(result)
    for _, server in pairs(data.data) do
        if server.id ~= currentJobId and server.playing < server.maxPlayers then
            table.insert(servers, server.id)
        end
    end

    -- üîÄ Chuy·ªÉn server
    if #servers > 0 then
        local randomServer = servers[math.random(1, #servers)]

        WindUI:Notify({
            Title = "Server Hop",
            Content = "üîÅ ƒêang chuy·ªÉn sang server m·ªõi...",
            Duration = 3,
            Type = "info"
        })

        task.wait(1)
        TeleportService:TeleportToPlaceInstance(gameId, randomServer, Players.LocalPlayer)
    else
        WindUI:Notify({
            Title = "Server Hop",
            Content = "‚ùå Kh√¥ng t√¨m th·∫•y server ph√π h·ª£p.",
            Duration = 4,
            Type = "warning"
        })
    end
end

-- üîò N√∫t WindUI
StTab:Button({
    Title = "Server Hop",
    Desc = "Chuy·ªÉn sang server ng·∫´u nhi√™n kh√°c",
    Callback = function()
        serverHop()
    end,
})
